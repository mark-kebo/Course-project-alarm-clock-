MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;processor    PIC16F877
Warning[205]: Found directive in column 1. (include)
                      00002 include  <P16F877.INC>
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Jul 02 2017
                      00005 ;  MPASM PIC16F877 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2017 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00541         LIST
Warning[205]: Found directive in column 1. (errorlevel)
                      00003 errorlevel   -302
                      00004         ;  директивы  типа  контроллера,  под-
                      00005         ;ключения  заголовочного  файла  и  вы-
                      00006         ;вода сообщений об ошибках
                      00007 #define   bank0  bcf STATUS,  RP0
                      00008 #define   bank1  bsf STATUS,  RP0
                      00009 ; директивы, позволяющие заменять в
                      00010         ;теле  ПО  команды,  указанные  после
                      00011         ;этой  директивы  (bcf  ,  bsf)  –  метками
                      00012         ;bank0, bank1. Обратную замену произ-
                      00013         ;водит компилятор
  00000020            00014 WAIT        equ     0x20
  00000026            00015 fCOUNTER    equ     0x26
  00000027            00016 fCOUNTER2   equ     0x27
  00000030            00017 TIME_HH1    equ     0x30
  00000031            00018 TIME_HH2    equ     0x31
  00000032            00019 TIME_MM1    equ     0x32
  00000033            00020 TIME_MM2    equ     0x33
  00000034            00021 TIME_SS1    equ     0x34
  00000035            00022 TIME_SS2    equ     0x35
  00000036            00023 DAY         equ     0x36
  00000037            00024 ALARM_HH1   equ     0x37
  00000038            00025 ALARM_HH2   equ     0x38
  00000039            00026 ALARM_MM1   equ     0x39
  0000003A            00027 ALARM_MM2   equ     0x3A
  0000003B            00028 Key1        equ     0x3B
  0000003C            00029 Key2        equ     0x3C
  0000003D            00030 Key3        equ     0x3D
  0000003E            00031 Key4        equ     0x3E
  0000003F            00032 Key5        equ     0x3F
  00000040            00033 Key6        equ     0x40
  00000041            00034 Key7        equ     0x41
  00000042            00035 Key8        equ     0x42
  00000043            00036 Key9        equ     0x43
  00000044            00037 fCOUNTER1   equ     0x44
  00000045            00038 TEMP_TIME_HH1    equ        0x45
  00000046            00039 TEMP_TIME_HH2    equ        0x46
  00000047            00040 TEMP_TIME_MM1    equ        0x47
  00000048            00041 TEMP_TIME_MM2    equ        0x48
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000049            00042 TEMP_TIME_SS1    equ        0x49
  0000004A            00043 TEMP_TIME_SS2    equ        0x4A
  0000004B            00044 TEMP_DAY         equ        0x4B
  0000004C            00045 TEMP_ALARM_HH1   equ        0x4C
  0000004D            00046 TEMP_ALARM_HH2   equ        0x4D
  0000004E            00047 TEMP_ALARM_MM1   equ        0x4E
  0000004F            00048 TEMP_ALARM_MM2   equ        0x4F
  00000050            00049 NumPressKey      equ        0x50
                      00050     ;вспомогательные  регистры,  назначе-
                      00051         ;ние которых приведено в комментариях
  0002                00052     constant   DS = .2
  0002                00053     constant   RST = .2
                      00054         ;  директивы,  ставящие в  соответствие
                      00055         ;меткам DS  и  RST  значение  0.  Анало-
                      00056         ;гия директив equ для имен регистров.
                      00057 
                      00058 wait  macro     time
                      00059     movlw    (time/5)-1
                      00060     movwf    WAIT
                      00061     call    wait5u
                      00062     endm
                      00063         ;макрос паузы с именем wait. Особен-
                      00064         ;ность этого макроса состоит в том, что
                      00065         ;у  него  имеется  параметр  –  time.  При
                      00066         ;вызове  макроса  значение  параметра
                      00067         ;указывается  после  имени  макроса  в
                      00068         ;виде  целого  десятичного  числа  крат-
                      00069         ;ного  5  (в  данном  примере).  В  теле
                      00070         ;макроса  это  число  подставляется  в
                      00071         ;«переменную» time и далее использу-
                      00072         ;ется вычисленное значение (которое в
                      00073         ;данном случае  выступает  в  роли  кон-
                      00074         ;станты, записываемой в W). Вместе с
                      00075         ;процедурой  wait5u  длительность  за-
                      00076         ;держки,  обеспечиваемая  макросом
                      00077         ;равна time микросекунд
                      00078 
                      00079     org 0x0000
0000   0183           00080     clrf STATUS
0001   3000           00081     movlw 0x00
0002   008A           00082     movwf PCLATH
0003   2???           00083     goto begin
                      00084         ;выбор нулевой страницы памяти ко-
                      00085         ;манд и размещение на ней откомпили-
                      00086         ;рованного кода
                      00087 
0004                  00088 begin
0004   1683           00089     bank1  ; выбор первого банка памяти. Для вы-
                      00090         ;зова используется метка bank1, объяв-
                      00091         ;ленная выше директивой #define
0005   308F           00092     movlw 0x8F
0006   0081           00093     movwf OPTION_REG
0007   0064           00094     clrwdt
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00095         ;установка  максимального  времени
                      00096         ;срабатывания  сторожевого  таймера  и
                      00097         ;его сброс
0008   018B           00098     clrf INTCON
0009   018C           00099     clrf PIE1
000A   018D           00100     clrf PIE2
                      00101         ;отключение  прерываний  и  их  обработки
000B   3000           00102     movlw .0
000C   0086           00103     movwf TRISB
000D   0087           00104     movwf TRISC
000E   0089           00105     movwf TRISE
                      00106         ; конфигурирование  портов  В, С, Е
000F   30F8           00107     movlw b'11111000' 
0010   0085           00108     movwf TRISA 
0011   3000           00109     movlw b'00000000'
0012   0088           00110     movwf TRISD
0013   300F           00111     movlw b'00001111'
0014   0081           00112     movwf OPTION_REG
                      00113         ;конфигурирование  RD0  как  входа
                      00114         ;для  установки  на  нем  «1»  в  качестве
                      00115         ;исходного  состояния  интерфейса  «1-Wire»
0015   019F           00116     clrf ADCON1 
0016   149F           00117     bsf ADCON1,0x01 
0017   151F           00118     bsf ADCON1,0x02 
0018   1283           00119     bank0
0019   01BB           00120     clrf Key1    
001A   01BC           00121     clrf Key2       
001B   01BD           00122     clrf Key3       
001C   01BE           00123     clrf Key4       
001D   01BF           00124     clrf Key5      
001E   01C0           00125     clrf Key6       
001F   01C1           00126     clrf Key7      
0020   01C2           00127     clrf Key8      
0021   01C3           00128     clrf Key9       
0022   0187           00129     clrf PORTC
0023   0188           00130     clrf PORTD
                      00131 ; подготовка к передаче команд на контроллер
                      00132 ;HD путем установки RC0=0
0024   3001           00133     movlw 0x01
0025   2???           00134     call write
0026   300F           00135     movlw 0x0f
0027   2???           00136     call delay
                      00137 ; передача команды Clear  Display для очистки
                      00138 ;дисплея и установки счетчика адреса видеопа-
                      00139 ;мяти  на  нулевой  адрес  (первое  знакоместо  в
                      00140 ;верхней строке), с необходимой задержкой
0028   0064           00141     clrwdt
0029   3038           00142     movlw 0x38
002A   2???           00143     call write
002B   300F           00144     movlw 0x0f
002C   2???           00145     call delay
                      00146 
                      00147 ; передача команды Function Set для установки
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00148 ;режима  2-х  строчного  индикатора,  размера
                      00149 ;знакоместа 5х7 и 8 разрядной шины данных
002D   3006           00150     movlw 0x06
002E   2???           00151     call write
002F   300F           00152     movlw 0x0f
0030   2???           00153     call delay
                      00154 ;передача  команды  Entry  Mode  Set  для  уста-
                      00155 ;новки режима увеличения счетчика адреса ви-
                      00156 ;деопамяти, после каждой записи символа в нее,
                      00157 ;при неподвижности видеопамяти относительно
                      00158 ;индикатора
0031   300C           00159     movlw 0x0c
0032   2???           00160     call write
0033   300F           00161     movlw 0x0f
0034   2???           00162     call delay
                      00163 ;  передача  команды  Display  ON/OFF  control
                      00164 ;для включения дисплея с отключенным курсо-
                      00165 ;ром.  На  этом  этап инициализации дисплея за-
                      00166 ;кончен.
0035   3033           00167         movlw   0x33
0036   00B0           00168         movwf   TIME_HH1
0037   3032           00169         movlw   0x32
0038   00B1           00170         movwf   TIME_HH2
0039   3030           00171         movlw   0x30
003A   00B2           00172         movwf   TIME_MM1
003B   3035           00173         movlw   0x35
003C   00B3           00174         movwf   TIME_MM2
003D   3030           00175         movlw   0x30
003E   00B4           00176         movwf   TIME_SS1
003F   00B5           00177         movwf   TIME_SS2
0040   00B7           00178         movwf   ALARM_HH1
0041   00B8           00179         movwf   ALARM_HH2
0042   00B9           00180         movwf   ALARM_MM1
0043   00BA           00181         movwf   ALARM_MM2
0044   00C5           00182         movwf   TEMP_TIME_HH1
0045   00C6           00183         movwf   TEMP_TIME_HH2
0046   00C7           00184         movwf   TEMP_TIME_MM1
0047   00C8           00185         movwf   TEMP_TIME_MM2
0048   00C9           00186         movwf   TEMP_TIME_SS1
0049   00CA           00187         movwf   TEMP_TIME_SS2
004A   00CC           00188         movwf   TEMP_ALARM_HH1
004B   00CD           00189         movwf   TEMP_ALARM_HH2
004C   00CE           00190         movwf   TEMP_ALARM_MM1
004D   00CF           00191         movwf   TEMP_ALARM_MM2 
004E   3000           00192         movlw   .0
004F   00B6           00193         movwf   DAY
0050   00CB           00194         movwf   TEMP_DAY
                      00195 
0051                  00196 START
0051   3030           00197         movlw   0x30
0052   00D0           00198         movwf   NumPressKey
0053   2???           00199         call Keyboard
0054   183B           00200         btfsc Key1,0
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0055   2???           00201         call change_time
                      00202         
                      00203         
0056   1007           00204         bcf PORTC, 0
0057   3080           00205         movlw b'10000000'
0058   2???           00206         call write
0059   1407           00207         bsf PORTC,0
                      00208 
                      00209         ;Отрисовка первой строки
005A   0831           00210         movfw TIME_HH2
005B   2???           00211         call write
005C   0830           00212         movfw TIME_HH1
005D   2???           00213         call write
005E   303A           00214         movlw ':'
005F   2???           00215         call write
0060   0833           00216         movfw TIME_MM2
0061   2???           00217         call write
0062   0832           00218         movfw TIME_MM1
0063   2???           00219         call write
0064   303A           00220         movlw ':'
0065   2???           00221         call write
0066   0835           00222         movfw TIME_SS2
0067   2???           00223         call write
0068   0834           00224         movfw TIME_SS1
0069   2???           00225         call write
                      00226 
006A   3020           00227         movlw ' '
006B   2???           00228         call write
006C   3020           00229         movlw ' '
006D   2???           00230         call write
006E   0836           00231         movfw   DAY                             
006F   2???           00232         call    DEC                             
                      00233 
                      00234         ;Счет десятков секунд (0-6) - TIME_SS1
0070   0AB4           00235         incf TIME_SS1,1
0071   303A           00236         movlw 0x3A                      ; if !=10
0072   0634           00237         xorwf TIME_SS1, w;
0073   1D03           00238         btfss STATUS, 0x02
0074   2???           00239         goto end_clock
                      00240         ;обнуление TIME_MM1
0075   3030           00241         movlw 0x30
0076   00B4           00242         movwf   TIME_SS1
                      00243 
                      00244         ;Счет десятков секунд (0-6) - TIME_SS2
0077   0AB5           00245         incf TIME_SS2,1
0078   3036           00246         movlw 0x36                      ; if !=6
0079   0635           00247         xorwf TIME_SS2, w;
007A   1D03           00248         btfss STATUS, 0x02
007B   2???           00249         goto end_clock
                      00250         ;обнуление TIME_MM2
007C   3030           00251         movlw 0x30
007D   00B5           00252         movwf   TIME_SS2
                      00253         
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00254         ;Счет десятков минут (0-6) - TIME_MM1
007E   0AB2           00255         incf TIME_MM1,1
007F   303A           00256         movlw 0x3A                      ; if !=10
0080   0632           00257         xorwf TIME_MM1, w;
0081   1D03           00258         btfss STATUS, 0x02
0082   2???           00259         goto end_clock
                      00260         ;обнуление TIME_MM1
0083   3030           00261         movlw 0x30
0084   00B2           00262         movwf   TIME_MM1
                      00263 
                      00264         ;Счет десятков минут (0-6) - TIME_MM2
0085   0AB3           00265         incf TIME_MM2,1
0086   3036           00266         movlw 0x36                      ; if !=6
0087   0633           00267         xorwf TIME_MM2, w;
0088   1D03           00268         btfss STATUS, 0x02
0089   2???           00269         goto end_clock
                      00270         ;обнуление TIME_MM2
008A   3030           00271         movlw 0x30
008B   00B3           00272         movwf   TIME_MM2
                      00273 
                      00274         ;Счет десятков единиц часов - TIME_НН2, TIME_НН1
008C   0AB0           00275         incf TIME_HH1,1
008D   3034           00276         movlw 0x34                      ; if !=4
008E   0630           00277         xorwf TIME_HH1, w;
008F   1D03           00278         btfss STATUS, 0x02
0090   2???           00279         goto ten_clock
0091   3032           00280         movlw 0x32                      ; if !=2
0092   0631           00281         xorwf TIME_HH2, w;
0093   1D03           00282         btfss STATUS, 0x02
0094   2???           00283         goto ten_clock
0095   3030           00284         movlw 0x30
0096   00B0           00285         movwf   TIME_HH1
0097   00B1           00286         movwf   TIME_HH2
0098   0AB6           00287         incf    DAY,1
0099   3007           00288         movlw   .7                      ; inc переменной День
009A   0636           00289         xorwf DAY, w;
009B   1D03           00290         btfss STATUS, 0x02              ; Обнуление переменной при достижении воскресенья, 
009C   2???           00291         goto end_clock                  ; что бы при 00:00:00 перейти в понедельник
009D   3000           00292         movlw   .0
009E   00B6           00293         movwf   DAY
                      00294         
                      00295         
Warning[207]: Found label after column 1. (ten_clock)
009F                  00296         ten_clock
009F   303A           00297         movlw 0x3A                      ; if !=10
00A0   0630           00298         xorwf TIME_HH1, w;
00A1   1D03           00299         btfss STATUS, 0x02
00A2   2???           00300         goto end_clock
Message[305]: Using default destination of 1 (file).
00A3   0AB1           00301         incf    TIME_HH2
00A4   3030           00302         movlw 0x30
00A5   00B0           00303         movwf   TIME_HH1
                      00304         
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A6                  00305 end_clock
00A6   0064           00306         clrwdt
                      00307 
00A7   30FF           00308         movlw 0xff
00A8   2???           00309         call delay ;задержка крч
00A9   30FF           00310         movlw 0xff
00AA   2???           00311         call delay ;задержка крч
00AB   30FF           00312         movlw 0xff
00AC   2???           00313         call delay ;задержка крч
                      00314 
00AD   1007           00315         bcf PORTC, 0
00AE   30C4           00316         movlw b'11000100'
00AF   2???           00317         call write
                      00318 ; Установка RC0=0, для последующей передачи
                      00319 ;команды  на  контроллер  HD.  Передается  ко-
                      00320 ;манда Set DDRAM address,  устанавливающая
                      00321 ;счетчик  адреса  видеопамяти  на  начало  2-ой
                      00322 ;строки:  ячейку  с  адресом  (0х40  =  0100  0000).
                      00323 ;Это  необходимо  для  вывода  фразы  «TEM-
                      00324 ;PERATURA =» на второй строке индикатора.
                      00325 
00B0   1407           00326     bsf PORTC,0  ; установка RC0=1, для последующей передачи
                      00327 ;кодов символов второй строки на дисплей. Об-
                      00328 ;ратите внимание на то, что нигде не требуется
                      00329 ;изменения  банков  памяти: т.к. все регистры, с
                      00330 ;которыми работает ПО, находятся в 0-ом бан-
                      00331 ;ке.
00B1   3041           00332     movlw 'A'
00B2   2???           00333     call write
00B3   304C           00334     movlw 'L'
00B4   2???           00335     call write
00B5   3041           00336     movlw 'A'
00B6   2???           00337     call write
00B7   3052           00338     movlw 'R'
00B8   2???           00339     call write
00B9   304D           00340     movlw 'M'
00BA   2???           00341     call write
00BB   3020           00342     movlw ' '
00BC   2???           00343     call write
00BD   3020           00344     movlw ' '
00BE   2???           00345     call write
00BF   0838           00346     movfw ALARM_HH2
00C0   2???           00347     call write
00C1   0837           00348     movfw ALARM_HH1
00C2   2???           00349     call write
00C3   303A           00350     movlw ':'
00C4   2???           00351     call write
00C5   083A           00352     movfw ALARM_MM2
00C6   2???           00353     call write
00C7   0839           00354     movfw ALARM_MM1
00C8   2???           00355     call write
00C9   2???           00356     goto START
                      00357 
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00CA                  00358 write    ; процедура записи байта к контроллер HD
00CA   1303           00359     bcf STATUS, RP1
00CB   1283           00360     bcf STATUS, RP0
00CC   0086           00361     movwf PORTB
00CD   1507           00362     bsf PORTC, 2
00CE   3001           00363     movlw 0x01
00CF   2???           00364     call delay
00D0   1107           00365     bcf PORTC, 2
00D1   0008           00366     return
                      00367         ; перед вызовом этой процедуры в W помеща-
                      00368         ;ется байт, который надо записать в HD. Далее
                      00369         ;он передается в PORTB и формируется отрица-
                      00370         ;тельный перепад на RC2, путем предваритель-
                      00371         ;ной  его  установки  в  «1»,  удержания  этого
                      00372         ;уровня в течение некоторого времени (опреде-
                      00373         ;ляемого временем задержки delay  при  W=1) и
                      00374         ;сброса его в «0».
                      00375 
                      00376    ;  процедура  задержки,  время  которой  можно
                      00377         ;регулировать, задавая число в W
00D2                  00378 delay
00D2   1303           00379     bcf   STATUS, RP1
00D3   1283           00380     bcf   STATUS, RP0
00D4   00A7           00381     movwf   fCOUNTER2
00D5   01A6           00382     clrf    fCOUNTER
                      00383 
                      00384 
00D6                  00385 BD_Loop
00D6   0064           00386     clrwdt
00D7   0BA6           00387     decfsz  fCOUNTER, f
00D8   2???           00388     goto    BD_Loop
00D9   0BA7           00389     decfsz  fCOUNTER2, f
00DA   2???           00390     goto    BD_Loop
00DB   0008           00391     return
                      00392     
                      00393     ;---------
00DC                  00394 change_time
00DC   2???           00395     call Keyboard
00DD   30FF           00396     movlw 0xff
00DE   2???           00397     call delay ;задержка крч
00DF   30FF           00398     movlw 0xff
00E0   2???           00399     call delay ;задержка крч
00E1   183B           00400     btfsc Key1,0
00E2   2???           00401     call correct_T_plus  ;если нажали кнопку 1 переходим в настройку времени (inc)
00E3   183D           00402     btfsc Key3,0
00E4   2???           00403     goto save_T          ;сохранение и переход к другой цифре путем инкремента NPK
00E5   183E           00404     btfsc Key4,0
00E6   2???           00405     goto START
                      00406     
00E7   1007           00407     bcf PORTC, 0
00E8   3080           00408     movlw b'10000000'
00E9   2???           00409     call write
00EA   1407           00410     bsf PORTC,0
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00411         ;Отрисовка первой строки
00EB   0846           00412     movfw TEMP_TIME_HH2
00EC   2???           00413     call write
00ED   0845           00414     movfw TEMP_TIME_HH1
00EE   2???           00415     call write
00EF   303A           00416     movlw ':'
00F0   2???           00417     call write
00F1   0848           00418     movfw TEMP_TIME_MM2
00F2   2???           00419     call write
00F3   0847           00420     movfw TEMP_TIME_MM1
00F4   2???           00421     call write
00F5   303A           00422     movlw ':'
00F6   2???           00423     call write
00F7   084A           00424     movfw TEMP_TIME_SS2
00F8   2???           00425     call write
00F9   0849           00426     movfw TEMP_TIME_SS1
00FA   2???           00427     call write
00FB   2???           00428     goto change_time
                      00429     ;---------
                      00430 
Message[305]: Using default destination of 1 (file).
00FC   0782           00431 DEC             addwf   PCL
00FD   2???           00432                 goto monday
00FE   2???           00433                 goto tuesday
00FF   2???           00434                 goto wednesday  
0100   2???           00435                 goto thursday    
0101   2???           00436                 goto friday             
0102   2???           00437                 goto saturday           
0103   2???           00438                 goto sunday             
0104   0008           00439                 return
                      00440                 
                      00441 ;Отрисовка дней недели
0105                  00442 monday          ;понедельник
0105   304D           00443     movlw 'M'
0106   2???           00444     call write
0107   304F           00445     movlw 'O'
0108   2???           00446     call write
0109   304E           00447     movlw 'N'
010A   2???           00448     call write
010B   2???           00449     goto exday
010C                  00450 tuesday         ;вторник
010C   3054           00451     movlw 'T'
010D   2???           00452     call write
010E   3055           00453     movlw 'U'
010F   2???           00454     call write
0110   3045           00455     movlw 'E'
0111   2???           00456     call write
0112   2???           00457     goto exday
0113                  00458 wednesday       ;среда
0113   3057           00459     movlw 'W'
0114   2???           00460     call write
0115   3045           00461     movlw 'E'
0116   2???           00462     call write
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0117   3044           00463     movlw 'D'
0118   2???           00464     call write
0119   2???           00465     goto exday
011A                  00466 thursday        ;четверг
011A   3054           00467     movlw 'T'
011B   2???           00468     call write
011C   3048           00469     movlw 'H'
011D   2???           00470     call write
011E   3055           00471     movlw 'U'
011F   2???           00472     call write
0120   2???           00473     goto exday
0121                  00474 friday          ;пятница
0121   3046           00475     movlw 'F'
0122   2???           00476     call write
0123   3052           00477     movlw 'R'
0124   2???           00478     call write
0125   3049           00479     movlw 'I'
0126   2???           00480     call write
0127   2???           00481     goto exday
0128                  00482 saturday        ;суббота
0128   3053           00483     movlw 'S'
0129   2???           00484     call write
012A   3041           00485     movlw 'A'
012B   2???           00486     call write
012C   3054           00487     movlw 'T'
012D   2???           00488     call write
012E   2???           00489     goto exday
012F                  00490 sunday          ;воскресенье
012F   3053           00491     movlw 'S'
0130   2???           00492     call write
0131   3055           00493     movlw 'U'
0132   2???           00494     call write
0133   304E           00495     movlw 'N'
0134   2???           00496     call write
Warning[207]: Found label after column 1. (exday)
0135                  00497     exday
Warning[203]: Found opcode in column 1. (return)
0135   0008           00498 return
                      00499       
                      00500     ;==============================================
0136                  00501 Keyboard
0136   1283           00502     bcf STATUS, RP0
0137   1303           00503     bcf STATUS, RP1
0138   01BB           00504     clrf Key1 
0139   01BC           00505     clrf Key2 
013A   01BD           00506     clrf Key3
013B   01BE           00507     clrf Key4 
013C   01BF           00508     clrf Key5 
013D   01C0           00509     clrf Key6
013E   01C1           00510     clrf Key7 
013F   01C2           00511     clrf Key8 
0140   01C3           00512     clrf Key9
                      00513     
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0141                  00514 col1
0141   1405           00515     bsf PORTA,0
0142   1085           00516     bcf PORTA,1
0143   1105           00517     bcf PORTA,2
                      00518     
                      00519     ;movlw .24
                      00520     ;call small_delay
                      00521     
0144   0805           00522     movf PORTA,W
0145   3938           00523     andlw 0x38
                      00524     
0146   1903           00525     btfsc STATUS,Z
0147   2???           00526     goto col2
                      00527     ;movlw .250
                      00528     ;call small_delay
                      00529     
0148   1985           00530     btfsc PORTA,3
0149   0ABB           00531     incf Key1,F
014A   1A05           00532     btfsc PORTA,4
014B   0ABE           00533     incf Key4,F
014C   1A85           00534     btfsc PORTA,5
014D   0AC1           00535     incf Key7,F
                      00536     
014E                  00537 col2
014E   1005           00538     bcf PORTA,0
014F   1485           00539     bsf PORTA,1
0150   1105           00540     bcf PORTA,2
                      00541     
                      00542     ;movlw .24
                      00543     ;sd
                      00544     
0151   0805           00545     movf PORTA,W
0152   3938           00546     andlw 0x38
                      00547     
0153   1903           00548     btfsc STATUS,Z
0154   2???           00549     goto col3
                      00550     ;movlw .250
                      00551     ;sd
                      00552     
0155   1985           00553     btfsc PORTA,3
0156   0ABC           00554     incf Key2,F
0157   1A05           00555     btfsc PORTA,4
0158   0ABF           00556     incf Key5,F
0159   1A85           00557     btfsc PORTA,5
015A   0AC2           00558     incf Key8,F
                      00559     
015B                  00560 col3
015B   1005           00561     bcf PORTA,0
015C   1085           00562     bcf PORTA,1
015D   1505           00563     bsf PORTA,2
                      00564     
                      00565     ;movlw .24
                      00566     ;sd
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00567     
015E   0805           00568     movf PORTA,W
015F   3938           00569     andlw 0x38
                      00570     
0160   1903           00571     btfsc STATUS,Z
0161   0008           00572     return          ;hz
                      00573     ;movlw .250
                      00574     ;sd
                      00575     
0162   1985           00576     btfsc PORTA,3
0163   0ABD           00577     incf Key3,F
0164   1A05           00578     btfsc PORTA,4
0165   0AC0           00579     incf Key6,F
0166   1A85           00580     btfsc PORTA,5
0167   0AC3           00581     incf Key9,F
0168   0008           00582     return
                      00583 ;==============================================
0169                  00584 correct_T_plus
0169   3030           00585     movlw 0x30                  ; если количество нажатий 0, то инкрементируем
016A   0650           00586     xorwf NumPressKey, w;       ; временную переменную Н2,
016B   1903           00587     btfsc STATUS, 0x02          ; и проводим проверку на != 3 этой переменной
016C   2???           00588     call correct_H2
016D   0008           00589     return
                      00590     
016E                  00591 correct_H2
016E   0AC6           00592     incf TEMP_TIME_HH2,1
016F   3033           00593     movlw 0x33                  ; if !=3
0170   0646           00594     xorwf TEMP_TIME_HH2, w;
0171   1D03           00595     btfss STATUS, 0x02
0172   0008           00596     return
0173   3030           00597     movlw       0x30
0174   00C6           00598     movwf       TEMP_TIME_HH2
0175   0008           00599     return
                      00600 
0176                  00601 save_T
0176   3030           00602     movlw 0x30                  ; записываем значение временной переменной в постоянную (NPK 
0177   0650           00603     xorwf NumPressKey, w        ; необходим для определения ячейки, в которую записываем
0178   1903           00604     btfsc STATUS, 0x02          ; значение)
0179   2???           00605     call change_H2
017A   0AD0           00606     incf NumPressKey,1          ; NPK инкрементируем
017B   2???           00607     goto START
                      00608     
017C                  00609 change_H2
017C   0846           00610     movfw TEMP_TIME_HH2
017D   00B1           00611     movwf TIME_HH2
017E   0008           00612     return
                      00613     
017F   2???           00614     goto START
                      00615   
0180                  00616 small_delay:
0180   00C4           00617     movwf fCOUNTER1
0181   0064           00618     clrwdt
0182   0BC4           00619     decfsz fCOUNTER1,F
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0183   2???           00620     goto $-2
0184   0008           00621     return
Warning[205]: Found directive in column 1. (end)
                      00622 end  ; конец программы
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ALARM_HH1                         00000037
ALARM_HH2                         00000038
ALARM_MM1                         00000039
ALARM_MM2                         0000003A
BCLIE                             00000003
BCLIF                             00000003
BD_Loop                           000000D6
BF                                00000000
BRGH                              00000002
C                                 00000000
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CKE                               00000006
CKP                               00000004
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

CREN                              00000004
CSRC                              00000007
D                                 00000005
DATA_ADDRESS                      00000005
DAY                               00000036
DC                                00000001
DEC                               000000FC
DS                                00000002
D_A                               00000005
D_NOT_A                           00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FERR                              00000002
FSR                               00000004
GCEN                              00000007
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IRP                               00000007
Key1                              0000003B
Key2                              0000003C
Key3                              0000003D
Key4                              0000003E
Key5                              0000003F
Key6                              00000040
Key7                              00000041
Key8                              00000042
Key9                              00000043
Keyboard                          00000136
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
NumPressKey                       00000050
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
PSPMODE                           00000004
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RST                               00000002
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SEN                               00000000
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
START                             00000051
STATUS                            00000003
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TEMP_ALARM_HH1                    0000004C
TEMP_ALARM_HH2                    0000004D
TEMP_ALARM_MM1                    0000004E
TEMP_ALARM_MM2                    0000004F
TEMP_DAY                          0000004B
TEMP_TIME_HH1                     00000045
TEMP_TIME_HH2                     00000046
TEMP_TIME_MM1                     00000047
TEMP_TIME_MM2                     00000048
TEMP_TIME_SS1                     00000049
TEMP_TIME_SS2                     0000004A
TIME_HH1                          00000030
TIME_HH2                          00000031
TIME_MM1                          00000032
TIME_MM2                          00000033
TIME_SS1                          00000034
TIME_SS2                          00000035
TMR0                              00000001
TMR0IE                            00000005
TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

TXSTA                             00000098
UA                                00000001
W                                 00000000
WAIT                              00000020
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_.org_0_0183                      00000183
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_WRT_OFF                          00003DFF
_WRT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
bank0                             bcf STATUS,  RP0
bank1                             bsf STATUS,  RP0
begin                             00000004
change_H2                         0000017C
MPASM 5.75                       FISH2_4.ASM   10-16-2017  21:51:23         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

change_time                       000000DC
col1                              00000141
col2                              0000014E
col3                              0000015B
correct_H2                        0000016E
correct_T_plus                    00000169
delay                             000000D2
end_clock                         000000A6
exday                             00000135
fCOUNTER                          00000026
fCOUNTER1                         00000044
fCOUNTER2                         00000027
friday                            00000121
monday                            00000105
saturday                          00000128
save_T                            00000176
small_delay                       00000180
sunday                            0000012F
ten_clock                         0000009F
thursday                          0000011A
tuesday                           0000010C
wait                              
wednesday                         00000113
write                             000000CA

Errors   :     0
Warnings :     6 reported,     0 suppressed
Messages :     2 reported,    12 suppressed

